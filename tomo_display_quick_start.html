

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick Start for tomo_display &mdash; IDL Tomography Processing</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/my_theme.css?v=254ed751" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=60dbed4a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Processing options" href="processing_options.html" />
    <link rel="prev" title="File formats" href="file_formats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            IDL Tomography
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_formats.html">File formats</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start for tomo_display</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#read-camera-file">Read camera file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualizing-raw-data">Visualizing raw data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualizing-normalized-data">Visualizing normalized data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimizing-rotation-center">Optimizing rotation center</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selecting-optimization-method">Selecting optimization method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-slices-for-optimization">Selecting slices for optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-center-range-and-step-for-optimization">Selecting center, range and step for optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-optimization">Manual optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correcting-rotation-tilt">Correcting rotation tilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-plots">Optimization plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconstruction">Reconstruction</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="processing_options.html">Processing options</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_display.html">Visualize with image_display</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagej.html">Visualize with ImageJ</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripting.html">Scripting and batch processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">IDL Tomography</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quick Start for tomo_display</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tomo_display_quick_start.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quick-start-for-tomo-display">
<h1>Quick Start for tomo_display<a class="headerlink" href="#quick-start-for-tomo-display" title="Link to this heading"></a></h1>
<p>If you are running the licensed version of IDL then start IDL and type the IDL command <em>tomo_display</em>.
If you are running the IDL Virtual Machine on Windows then double-click on the tomo_display.sav file,
or open the IDL Virtual Machine from the Windows Start menu and browse for the file.
On Linux type the command <code class="docutils literal notranslate"><span class="pre">idl</span> <span class="pre">-vm=tomo_display.sav</span></code></p>
<p>When tomo_display first opens it looks like this:</p>
<figure class="align-center" id="id1">
<img alt="_images/tomo_display_start.png" src="_images/tomo_display_start.png" />
<figcaption>
<p><span class="caption-text"><strong>tomo_display window on startup</strong></span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Note that all regions of the screen are disabled.</p>
<section id="read-camera-file">
<h2>Read camera file<a class="headerlink" href="#read-camera-file" title="Link to this heading"></a></h2>
<p>To begin process use the <strong>File/Read camera file</strong> menu to browse for a raw data file.  This can be a single .h5 for recent data,
or any of the 3 .nc files for pre-2020 dataset.  After reading the file the screen will look like this:</p>
<figure class="align-center" id="id2">
<img alt="_images/tomo_display_after_read_camera.png" src="_images/tomo_display_after_read_camera.png" />
<figcaption>
<p><span class="caption-text"><strong>tomo_display window after reading a camera file</strong></span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Note the the Preprocess, Visualize, and Movies screen regions are now enabled.</p>
</section>
<section id="visualizing-raw-data">
<h2>Visualizing raw data<a class="headerlink" href="#visualizing-raw-data" title="Link to this heading"></a></h2>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region opens an <strong>image_display</strong> window like this:</p>
<figure class="align-center" id="id3">
<img alt="_images/image_display_raw_Z.png" src="_images/image_display_raw_Z.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the raw camera data in the Z direction (projection)</strong></span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading"></a></h2>
<p>Pressing the Preprocess button in the Preprocess region will perform preprocessing.  This consists of</p>
<ul class="simple">
<li><p>Subtracting the dark current from all flat fields and projections</p></li>
<li><p>Averaging the flat fields and removing zingers (hot pixels) from them using double-correlation</p></li>
<li><p>Dividing each projection by the average flat field, and multiplying by a scale factor (default=10000)</p></li>
<li><p>Removing zingers from the normalized projections</p></li>
<li><p>If the <strong>Data type</strong> is UInt16 converts to that data type.  Float32 should normally be used if not saving to disk.</p></li>
<li><p>Optionally saving the normalized data to an HDF5 or netCDF file</p></li>
</ul>
<p>After preprocessing the screen will look like this:</p>
<figure class="align-center" id="id4">
<img alt="_images/tomo_display_after_preprocess.png" src="_images/tomo_display_after_preprocess.png" />
<figcaption>
<p><span class="caption-text"><strong>tomo_display window after preprocessing</strong></span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="visualizing-normalized-data">
<h2>Visualizing normalized data<a class="headerlink" href="#visualizing-normalized-data" title="Link to this heading"></a></h2>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region with Direction=Z opens an <strong>image_display</strong> window like this:</p>
<figure class="align-center" id="id5">
<img alt="_images/image_display_normalized_Z.png" src="_images/image_display_normalized_Z.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the normalized projection in the Z direction (projection)</strong></span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region with Direction=Y opens an <strong>image_display</strong> window like this:</p>
<figure class="align-center" id="id6">
<img alt="_images/image_display_normalized_Y.png" src="_images/image_display_normalized_Y.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the normalized projection in the Y direction (sinogram)</strong></span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="optimizing-rotation-center">
<h2>Optimizing rotation center<a class="headerlink" href="#optimizing-rotation-center" title="Link to this heading"></a></h2>
<section id="selecting-optimization-method">
<h3>Selecting optimization method<a class="headerlink" href="#selecting-optimization-method" title="Link to this heading"></a></h3>
<p>There are two methods available for optimizing the rotation center, “Entropy” and “0-180”.</p>
<p>Entropy reconstructs the slices with different rotation centers using the user-specified range and step size.
It computes the image entropy for each center, and selects the optimum center as the one with the lowest entropy.
Entropy is measured using the sharpness of the image histogram.  The entropy technique typically works well
for images that are dominated by absorption contrast (rather than phase contrast), and for which the entire sample
is mostly in the field of view.  It can fail for other types of data.  There is in principle no limit to the resolution
of the entropy method, and it can easily resolve rotation centers to less than 0.25 pixels.</p>
<p>0-180 is a simpler and faster method.  It uses the projections at 0 degrees and 180 degrees.  The 180 degree image is
reversed in the horizontal direction, and subtracted from the 0 degree image.  If the rotation axis were exactly in the middle
and the data had no noise or systematic errors then all pixels in the difference should be 0.  It then shift the 180 degree image
in 1 pixel increments over the user-specified range and step, and determines at which shift the difference is a minimum.
0-180 is more robust than the entropy method, and works even for images dominated by phase contrast or larger than the field
of view.</p>
</section>
<section id="selecting-slices-for-optimization">
<h3>Selecting slices for optimization<a class="headerlink" href="#selecting-slices-for-optimization" title="Link to this heading"></a></h3>
<p>The optimization is done for two slices, one near the top of the dataset and one near the bottom.
By default these slices are 10% down from the top and 10% up from the bottom.  The user
may need to adjust these slice numbers to select slices that are in the sample, and not in the
air or in very absorbing regions in the top or bottom of the sample.  The slice numbers can be
selected by using <strong>Display slice</strong> in the Z direction, moving the cursor and recording the <strong>Y pixel</strong>
value in the desired slices.</p>
</section>
<section id="selecting-center-range-and-step-for-optimization">
<h3>Selecting center, range and step for optimization<a class="headerlink" href="#selecting-center-range-and-step-for-optimization" title="Link to this heading"></a></h3>
<p>The <strong>Rotation center</strong> field selects the center of the range to be used in the optimization.
The <strong>Optimize range</strong> field selects the full range of the optimization, i.e. the optimization range is from center-range/2 to
center+range/2.
The <strong>Rotation step</strong> field selects the step size in pixels for the optimization.
For the entropy method there is in principle no limit to how small the step size can be, and it can easily resolve
rotation centers to less than 0.25 pixels.
The 0-180 method has a minimum useful step size of 0.5 pixels, because the shifts are limited to integer pixel increments.</p>
</section>
<section id="manual-optimization">
<h3>Manual optimization<a class="headerlink" href="#manual-optimization" title="Link to this heading"></a></h3>
<p>If neither neither the entropy or 0-180 methods produce satisfactory results, it is possible to manually optimize
the center.  For both the upper and lower slices manually change the <strong>Rotation center</strong> for that slice and press
<strong>Reconstruct slice</strong>.  Determine which rotation center gives a reconstruction with the fewest artifacts.  Slices
with small highly absorbing objects are ideal for this, since they show “crescents” facing left or right if the center
is wrong.  The centers in the upper and lower slices should be very similar.</p>
</section>
<section id="correcting-rotation-tilt">
<h3>Correcting rotation tilt<a class="headerlink" href="#correcting-rotation-tilt" title="Link to this heading"></a></h3>
<p>The reason for using slices near the top and bottom is to judge whether the rotation axis is correctly aligned
to be parallel to the columns in the camera.  If it is then the center will be the same at the top and bottom.
If it is not, and the error is significant (e.g. 1 pixel or more) there are two ways to fix the problem.
The first is to use the <strong>Correct rotation tilt</strong> button. This will rotate all of the projections by the angular error,
and hence make the rotation center be the same on the top and bottom.
The second method is to adjust the mechanical alignment of the system for future datasets.</p>
</section>
<section id="optimization-plots">
<h3>Optimization plots<a class="headerlink" href="#optimization-plots" title="Link to this heading"></a></h3>
<p>This is the plot produced when optimizing with the 0-180 method, using center=960, range=10, step=0.5
It found the optimum center of 961.5 for the upper slice (120) and 961.0 for the lower slice (1080).</p>
<figure class="align-center" id="id7">
<img alt="_images/0-180_optimization.png" src="_images/0-180_optimization.png" />
<figcaption>
<p><span class="caption-text"><strong>0-180 optimization plot</strong></span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This is the plot produced when optimizing with the entropy method, using center=960, range=10, step=0.25
It found the optimum center of 961.25 for the upper slice (120) and 960.75 for the lower slice (1080).
These values are within 0.25 pixels of those found with the 0-180 method.</p>
<figure class="align-center" id="id8">
<img alt="_images/entropy_optimization.png" src="_images/entropy_optimization.png" />
<figcaption>
<p><span class="caption-text"><strong>Entropy optimization plot</strong></span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<section id="reconstruction">
<h2>Reconstruction<a class="headerlink" href="#reconstruction" title="Link to this heading"></a></h2>
<p>Once the optimum rotation center is found, use the <strong>Reconstruct all</strong> button to reconstruct all of the slices.
The output data type can be signed 16-bit integer (Int16), unsigned 16-bit integer (UInt16), or 32-bit floating point (Float32).
Normally <strong>Save result</strong> is set to Yes, so that the reconstruction is written to a file.
It can be set to “No” for tests where only in-memory reconstruction is needed.
The output <strong>File format</strong> can be netCDF or HDF5.  HDF5 is faster, more widely used, and recommended.  netCDF can be used for
backwards compatibility for older datasets.</p>
<p>After reconstruction the screen will look like this. Note that <strong>Visualize/Type</strong> is now “RECONSTRUCTED”, and the <strong>Preprocess</strong>
and <strong>Reconstruct</strong> regions are disabled.</p>
<figure class="align-center" id="id9">
<img alt="_images/tomo_display_after_reconstruction.png" src="_images/tomo_display_after_reconstruction.png" />
<figcaption>
<p><span class="caption-text"><strong>tomo_display window after reconstruction</strong></span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The <strong>Actual intensity range</strong> shows the min and max values of the reconstructed data.  The “Display intensity range”
min and max values can be set to control the displayed contrast when <strong>Manual</strong> is selected.</p>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region with Direction=Z displays a horizontal slice in an
<strong>image_display</strong> window like this.</p>
<figure class="align-center" id="id10">
<img alt="_images/image_display_reconstructed_Z.png" src="_images/image_display_reconstructed_Z.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the center reconstructed slice in the Z (vertical) direction</strong></span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region with Direction=Y displays a vertical slice parallel to the X-ray beam
in an <strong>image_display</strong> window like this.</p>
<figure class="align-center" id="id11">
<img alt="_images/image_display_reconstructed_Y.png" src="_images/image_display_reconstructed_Y.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the center reconstructed slice in the Y direction</strong></span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Pressing the <strong>Display slice</strong> button in the Visualize region with Direction=X displays a vertical slice perpendicular to the X-ray beam
in an <strong>image_display</strong> window like this.</p>
<figure class="align-center" id="id12">
<img alt="_images/image_display_reconstructed_X.png" src="_images/image_display_reconstructed_X.png" />
<figcaption>
<p><span class="caption-text"><strong>image_display window showing the center reconstructed slice in the X direction</strong></span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="file_formats.html" class="btn btn-neutral float-left" title="File formats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="processing_options.html" class="btn btn-neutral float-right" title="Processing options" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mark Rivers.
      <span class="lastupdated">Last updated on 2024-December-12.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>