<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>CARS Tomography Routines</TITLE>
</head>
 
<body>
<H1>CARS Tomography Routines</H1>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Sun Mar 19 16:11:18 2023.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#BACKPROJECT">BACKPROJECT</A>
<LI><A HREF="#GRIDREC">GRIDREC</A>
<LI><A HREF="#READ_TOMO_VOLUME">READ_TOMO_VOLUME</A>
<LI><A HREF="#REMOVE_TOMO_ARTIFACTS">REMOVE_TOMO_ARTIFACTS</A>
<LI><A HREF="#SINOGRAM">SINOGRAM</A>
<LI><A HREF="#TOMO::CORRECT_ROTATION_TILT">TOMO::CORRECT_ROTATION_TILT</A>
<LI><A HREF="#TOMO::OPTIMIZE_CENTER">TOMO::OPTIMIZE_CENTER</A>
<LI><A HREF="#TOMO::PREPROCESS">TOMO::PREPROCESS</A>
<LI><A HREF="#TOMO::READ_CAMERA_FILE">TOMO::READ_CAMERA_FILE</A>
<LI><A HREF="#TOMO::READ_SETUP">TOMO::READ_SETUP</A>
<LI><A HREF="#TOMO::RECONSTRUCT_VOLUME">TOMO::RECONSTRUCT_VOLUME</A>
<LI><A HREF="#TOMO_FILTER">TOMO_FILTER</A>
<LI><A HREF="#WRITE_TOMO_VOLUME">WRITE_TOMO_VOLUME</A>
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="BACKPROJECT">
<H2>BACKPROJECT</H2></A>
<A HREF="#GRIDREC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   BACKPROJECT

 PURPOSE:
   Reconstructs a sinogram into an image using backprojection.

 CATEGORY:
   Tomography data processing

 CALLING SEQUENCE:
   Result = BACKPROJECT(tomoParams, Sinogram, Angles)

 INPUTS:
   Sinogram:
       The input sinogram, dimensions NX x NANGLES.  This should have been 
       filtered before calling this function.
   Angles:
       An array of dimensions NANGLES which contains the angle in degrees of 
       each projection.

 OUTPUTS:
   This function returns the reconstructed image.

 PROCEDURE:
   This function simply calls the IDL RIEMANN procedure for each row in the 
   sinogram, using the ROW and BACKPROJECT keywords.  The BILINEAR and CUBIC 
   keywords are passed from BACKPROJECT to RIEMANN if they are present.

 EXAMPLE:
   r = backproject(sinogram, angles)

 MODIFICATION HISTORY:
   Written by:     Mark Rivers, May 13, 1998
</PRE><P>
<STRONG>(See backproject.pro)</STRONG><P>
<HR>
 
<A NAME="GRIDREC">
<H2>GRIDREC</H2></A>
<A HREF="#BACKPROJECT">[Previous Routine]</A>
<A HREF="#READ_TOMO_VOLUME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   GRIDREC

 PURPOSE:
   Performs tomographic reconstruction using the "gridrec" algorithm written
   by Bob Marr and Graham Campbell (not sure about authors) at BNL in 1997.
   The basic algorithm is based on FFTs.  It reconstructs 2 data sets at once, 
   one in the real part of the FFT and one in the imaginary part.

   This routine is 20-40 times faster than BACKPROJECT, and yields virtually
   identical reconstructions.

   This file uses CALL_EXTERNAL to call GridrecIDL.c which is a thin
   wrapper to grid.c, 

 CATEGORY:
   Tomography data processing

 CALLING SEQUENCE:
   GRIDREC, tomoParams, Sinogram1, Sinogram2, Angles, Image1, Image2

 INPUTS:
   Sinogram1:
       The first input sinogram, dimensions NX x NANGLES.  
   Sinogram2:
       The second input sinogram, dimensions NX x NANGLES.  
   Angles:
       An array of dimensions NANGLES which contains the angle in degrees of 
       each projection.

 KEYWORD PARAMETERS:
   CENTER: The column containing the rotation axis.  The default is the center
           of the sinogram.

 OUTPUTS:
   Image1:
       The reconstructed image from Sinogram1.  
   Image2:
       The reconstructed image from Sinogram2.  

   Note that the sizes of Image1 and Image2 are controlled by "grid" and will not 
   be equal NX*NX.  RECONSTRUCT_SLICE uses the IDL routine CONGRID to resize the 
   images to be NX*NX.

 PROCEDURE:
   This function uses CALL_EXTERNAL to call the shareable library GridrecIDL, 
   which is written in C.

 RESTRICTIONS:
   GRIDREC locates the GridrecIDL shareable library via the environment variable
   GRIDREC_SHARE.  This environment variable must be defined and must contain the
   name (typically including the path) to a valid shareable library or DLL.

 EXAMPLE:
   GRIDREC, s1, s2, angles, image1, image2, center=419

 MODIFICATION HISTORY:
   Written by:     Mark Rivers, March 4, 2000
   19-APR-2001 MLR Change units of ANGLES from radians to degrees.  Write
                   documentation header.
</PRE><P>
<STRONG>(See gridrec.pro)</STRONG><P>
<HR>
 
<A NAME="READ_TOMO_VOLUME">
<H2>READ_TOMO_VOLUME</H2></A>
<A HREF="#GRIDREC">[Previous Routine]</A>
<A HREF="#REMOVE_TOMO_ARTIFACTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   READ_TOMO_VOLUME

 PURPOSE:
   Reads in 3-D volume files written by WRITE_TOMO_VOLUME or TOMO::WRITE_VOLUME.
   This function is a simple wrapper around TOMO::READ_VOLUME.
   See the documentation for <A HREF="#TOMO::READ_VOLUME">TOMO::READ_VOLUME </A>
   for information on the input parameters and other details.

 PROCEDURE:
   This function simply creates a TOMO object and calls TOMO::READ_VOLUME.

 EXAMPLE:
   volume = READ_TOMO_VOLUME('diamond2.volume')

 MODIFICATION HISTORY:
   Written by: Mark Rivers, May 13, 1998
   06-APR-1999  MLR  Made file input optional, puts up dialog if it is not 
                     specified
   25-JAN-2000  MLR  Added /swap_if_big_endian keyword to openr to allow
                     files to be read on big-endian machines.
   23-FEB-2000  MLR  Added xrange, yrange, zrange keywords
   11-APR-2001  MLR  Put the original version in the TOMO class library, made this
                     function simply create a TOMO object and call TOMO::READ_VOLUME.
</PRE><P>
<STRONG>(See read_tomo_volume.pro)</STRONG><P>
<HR>
 
<A NAME="REMOVE_TOMO_ARTIFACTS">
<H2>REMOVE_TOMO_ARTIFACTS</H2></A>
<A HREF="#READ_TOMO_VOLUME">[Previous Routine]</A>
<A HREF="#SINOGRAM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   REMOVE_TOMO_ARTIFACTS

 PURPOSE:
   Removes artifacts from tomography images and sinograms.

 CATEGORY:
   Tomography data processing

 CALLING SEQUENCE:
   Result = REMOVE_TOMO_ARTIFACTS(Image)

 INPUTS:
   Image:  The input array from which artifacts are to be removed.

 KEYWORD PARAMETERS:
   IMAGE2:
       A second input and output image when doing DOUBLE_CORRELATION
   ZINGERS:
       Set this keyword to remove zingers from the input image
   DOUBLE_CORRELATION:
       Set this keyword to remove zingers from the input using double 
       correlation rather than a spatial detection
   RINGS:
       Set this keyword to remove ring artifacts from a sinogram
   DIFFRACTION:
       Set this keyword to removed diffraction artifacts from a sinogram
   WIDTH:          
       Set this keyword to adjust the size of the filter kernal used in the
       artifact removal.  The default is 9 pixels.
   THRESHOLD:  
       Set this keyword to adjust the threshold used in detecting zingers and
       diffraction artifacts.  The defaults are 1.2 for /ZINGER and 
       /DOUBLE_CORRELATION and 0.8 for/DIFFRACTION
   DEBUG:      
       Set this keyword to print debugging information

 OUTPUTS:
   This function returns an image with the specified artifacts removed.

 PROCEDURE:
   THIS STILL NEEDS TO BE DOCUMENTED.  For now, see the source code.

 EXAMPLE:
   r = remove_tomo_artifacts(sinogram, /Rings)

 MODIFICATION HISTORY:
   Written by:     Mark Rivers, May 13, 1998
   MLR 4/4/99 MLR  Added DOUBLE_CORRELATION keyword
   MLR 4/5/99 MLR  Added /EDGE_TRUNCATE to all calls to SMOOTH so that
                   smoothing works to the edges of the image
</PRE><P>
<STRONG>(See remove_tomo_artifacts.pro)</STRONG><P>
<HR>
 
<A NAME="SINOGRAM">
<H2>SINOGRAM</H2></A>
<A HREF="#REMOVE_TOMO_ARTIFACTS">[Previous Routine]</A>
<A HREF="#TOMO::CORRECT_ROTATION_TILT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   SINOGRAM

 PURPOSE:
   To convert raw tomography data into a sinogram.

 CATEGORY:
   Tomography

 CALLING SEQUENCE:
   result = SINOGRAM(Input, Angles)

 INPUTS:
   Input
       An array of raw tomography data. INPUT(I, J) is the intensity at
       position I for view angle J. Each row is assumed to contain at least
       one air value at each end for normalization.
   Angles
       An array of the angles of each row of the input.  Units are degrees.

   COG=cog
       This keyword is used to return the measured and fitted
       center-of-gravity data for the sinogram. The center-of-gravity data are
       very useful for diagnosing problems such as backlash, beam hardening,
       detector saturation, etc. COG is dimensioned (n_angles, 2), where
       n_angles is the number of angles in the input array. COG(*,0) is the
       measured center-of-gravity data. COG(*,1) is the fitted data. The
       following command can then be given after the SINOGRAM command
       IDL> PLOT, COG(*,0)
       IDL> OPLOT, COG(*,1)
       to see is the sinogram data are reasonable.
 RETURN:
       The output array containing the corrected sinogram. It is always of
       type FLOAT.

 PROCEDURE:
       This routine creates a sinogram from raw tomography data. It does the
       following:
       -   Averages the air values for "airPixels" pixels on the left and 
           right hand sides of the input.
       -   Logarithmation. output = -log(input/air). The air values are
           interpolated between the averaged values for the left and right 
           hand edges of the image for each row.  This step is not performed
           if the /FLUORESCENCE keyword is set.
       -   The measured center-of-gravity is fitted to a sinusoidal curve
           of the form Y = A(0) + A(1)*SIN(X + A(2)).
               A(0) is the rotation axis
               A(1) is the amplitude
               A(2) is the phase
           The fitting is done using routine CURVE_FIT in the User Library.
           The shifting is done using routine POLY_2D which can shift by 
           fractional pixels.
 MODIFICATION HISTORY:
   Created 21-OCT-1991 by Mark Rivers.
</PRE><P>
<STRONG>(See sinogram.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::CORRECT_ROTATION_TILT">
<H2>TOMO::CORRECT_ROTATION_TILT</H2></A>
<A HREF="#SINOGRAM">[Previous Routine]</A>
<A HREF="#TOMO::OPTIMIZE_CENTER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
  TOMO::CORRECT_ROTATION_TILT

 PURPOSE:
   This procedure rotates each projection by the specified angle.
   It can be used to correct for the rotation center not being parallel to the columns of the camera.

 CALLING SEQUENCE:
   TOMO->CORRECT_ROTATION_TILT, ANGLE

 INPUT PARAMETERS:
   ANGLE (required)
     The angle in degrees clockwise by which to rotate each projection.

; PROCEDURE:
   Uses the IDL ROT function.  tomo::pVolume is modified in place.
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::OPTIMIZE_CENTER">
<H2>TOMO::OPTIMIZE_CENTER</H2></A>
<A HREF="#TOMO::CORRECT_ROTATION_TILT">[Previous Routine]</A>
<A HREF="#TOMO::PREPROCESS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
  TOMO::OPTIMIZE_CENTER

 PURPOSE:
   This procedure performs the preprocessing on a tomography dataset, producing normalized data that
   is corrected for dark fields, flat fields, and zingers.
   The data must have been read into the tomo object with tomo::read_camera_file.
   The preprocessing parameters can be specified before calling this function with tomo::set_preprocess_params.

 CALLING SEQUENCE:
   TOMO->OPTIMIZE_CENTER, SLICES, CENTER, MERIT, WIDTH=WIDTH, STEP=STEP, METHOD=METHOD

 INPUT PARAMETERS:
   SLICES (required)
     A 2-element array containing the slice numbers to use for optimization.
     Normally one should be near the top of the projections and the other near the bottom
   CENTER (required)
     The initial guess of the optimum rotation center.
     
 OUTPUT PARAMETERS:
   MERIT:
     An array of [2, nCenter] where nCenter = WIDTH/STEP + 1. 
     This array contains the figure of merit for each rotation center for the upper and lower slices.  
     The minimum value is nominally the best rotation center.

 KEYWORD PARAMETERS
   WIDTH:
     The full-width of the rotation center search region in pixels. Default=10.
   STEP:
     The step size within the WIDTH for each trial rotation center.  
     Default=0.5 if METHOD='0-180' and 0.25 if METHOD='Entropy'.
   METHOD:
     The optimization method.  Valid choices are '0-180' and 'Entropy'.
     
 PROCEDURE:
   The IDL tomography documentation (https://CARS-UChicago.github.io/IDL_tomography) explains
   the optimization algorithms in detail.
   
   After the optimization the two slice numbers and the minimum values of MERIT are passed
   to TOMO::SET_ROTATION.  That routine sets tomo::rotationCenter and tomo::rotationCenterSlope
   which are used to set the rotation center of each slice during reconstruction.
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::PREPROCESS">
<H2>TOMO::PREPROCESS</H2></A>
<A HREF="#TOMO::OPTIMIZE_CENTER">[Previous Routine]</A>
<A HREF="#TOMO::READ_CAMERA_FILE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
  TOMO::PREPROCESS

 PURPOSE:
   This procedure performs the preprocessing on a tomography dataset, producing normalized data that
   is corrected for dark fields, flat fields, and zingers.
   The data must have been read into the tomo object with tomo::read_camera_file.
   The preprocessing parameters can be specified before calling this function with tomo::set_preprocess_params.

 CALLING SEQUENCE:
   TOMO->PREPROCESS

 PROCEDURE:
   This function performs the following steps:
   - Averages the dark fields if there is more than 1
   - Subtracts the dark current from each flat field field frame,
   - Removes zingers from flat field frames using REMOVE_TOMO_ARTIFACTS with
     /DOUBLE_CORRELATION if there is more than 1, or /ZINGERS if there is only 1.
   - Averages the flat fields if there is more than 1.
   - Calls the C++ code in tomoRecon to do the following:
     - Subtracts the dark current from each projection 
     - Divides projection by the average flat field
     - Removes zingers using a median filter with zingerWidth and zingerThreshold
     - Scales the normalized projection by preprocessScale
   - Optionally converts the normalized projections to UInt16 if preprocessDataType = 'UInt16'
   - Optionally writes the normalized data frames to a single disk file if .preprocessWriteOutput is true.
     The file can be written in HDF5 or netCDF format.
   - Replaces the raw data in tomo::pVolume with the normalized data.
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::READ_CAMERA_FILE">
<H2>TOMO::READ_CAMERA_FILE</H2></A>
<A HREF="#TOMO::PREPROCESS">[Previous Routine]</A>
<A HREF="#TOMO::READ_SETUP">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
  TOMO::READ_CAMERA_FILE

 PURPOSE:
   This procedure reads a tomography data set from 2 types of data files:
     - netCDF files.  There are 4 files
       - base_1.nc contains flat fields collected at the beginning
       - base_2.nc contains the projections
       - base_3.nc contains the flat fields collected at the end
       - base.setup ASCII file containing metadata including the pixel size and dark current.
       
     - HDF5 files.  There are 2 files:
       - base.h5     A single file HDF5 that contains the flat fields, dark fields, projections, and metadata
       - base.config An ASCII file containing metadata. 

 INPUT PARAMETERS:
   FILENAME (required):
     For netCDF this can be the name of any of the 3 netCDF files
     For HDF5 this is the name of the HDF5 file

 PROCEDURE:
   Reads the data into the tomo object, including these member variables
     nx, ny, nz
     xPixelSize, yPixelSize, zPixelSize
     pAngles
     pFlats
     pDarks
     pData
     rotationCenter       Initialized to nx/2
     rotationCenterSlope  Initialize to 0
  For netCDF files reads the .setup file with tomo::read_setup
  For HDF5 files reads the .config file with tomo::read_sample_config
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::READ_SETUP">
<H2>TOMO::READ_SETUP</H2></A>
<A HREF="#TOMO::READ_CAMERA_FILE">[Previous Routine]</A>
<A HREF="#TOMO::RECONSTRUCT_VOLUME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   TOMO::READ_SETUP

 PURPOSE:
   This function reads the setup information for a tomography data set from an
   ASCII file.

 CATEGORY:
   Tomography

 CALLING SEQUENCE:
   result = TOMO->READ_SETUP(File)

 INPUTS:
   File:
       The name of the input file.

 OUTPUTS:
   This function returns 0 if it was unable to read the file, 1 if it was
   successful.

 EXAMPLE:
       IDL>  status = TOMO->READ_SETUP('Sample1.setup')

 MODIFICATION HISTORY:
   Written by: Mark Rivers, Aug. 2001?
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO::RECONSTRUCT_VOLUME">
<H2>TOMO::RECONSTRUCT_VOLUME</H2></A>
<A HREF="#TOMO::READ_SETUP">[Previous Routine]</A>
<A HREF="#TOMO_FILTER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   TOMO::RECONSTRUCT_VOLUME

 PURPOSE:
   This procedure reconstructs a complete 3-D data set (X, Y, Theta) into a
   3-D (X, Y, Z) volume.  It reads its input from disk and writes its output
   back to disk.

 CATEGORY:
   Tomography.

 CALLING SEQUENCE:
   TOMO->RECONSTRUCT_VOLUME, Base_file

 INPUTS:
   Base_file:
       The base file name.  The input file is assumed to be named
       base_file+'.volume', and the output file will be named
       base_file+'_recon.volume'.  The input file is read with
       READ_TOMO_VOLUME and the output file is written with WRITE_TOMO_VOLUME.

 KEYWORD PARAMETERS:
   This procedure accepts all keywords accepted by READ_TOMO_VOLUME and
   RECONSTRUCT_SLICE and simply passes them to those routines via keyword
   inheritance.

   CENTER
       This keyword, which is passed to RECONSTRUCT_SLICE can either be a scaler (the
       normal case) or a 2-element array.  If it is a 2-element array then the
       center value passed to RECONSTRUCT_SLICE is interpolated between CENTER[0]
       for the first slice of the volume file to CENTER[1] at the last slice of the
       volume file.  This can be useful if the optimum center varies with slice
       depth.
   ANGLES
       An optional array of angles (in degrees) at which each projection was taken.
       This keyword is passed to RECONSTRUCT_SLICE.  If this keyword is missing
       then RECONSTRUCT_SLICE assumes even spacing from 0 to 180-delta degrees.
   SCALE
       The scale factor by which the data should be multiplied before writing as
       short integers to the output file.  The default is 1.e6.  Since the
       attenuation values are per-pixel, and are typically 0.001, this leads to
       integers in the range of 10,000.  If there are highly attenuating pixels the
       scale factor may need to be decreased to 1-5e5 to avoid integer overflow.
       The inverse of the SCALE is stored as the attribute volume:preprocessScale
       in the netCDF file.
;
 RESTRICTIONS:
   This procedure assumes a naming convention for the input and output files.
   The output is stored as 16 bit integers to save memory and disk space.
   This can reduce the dynamic range of the reconstructed data.

 PROCEDURE:
   This procedure simply does the following:
       - Reads a corrected input volume (X, Y, Theta) which is typically
         created with READ_TOMO_DATA
       - Calls RECONSTRUCT_SLICE for each row (slice) in the input volume
       - Scales the reconstructed data (floating poing) by 10000 and converts
         to 16 bit integers
       - Writes the reconstructed 3-D volume (X, Y, Z) back to disk with
         WRITE_TOMO_VOLUME

 EXAMPLE:
   reconstruct_volume, 'FOSSIL1', /AUTO_CENTER

 MODIFICATION HISTORY:
   Written by:    Mark Rivers, April 23, 1999
   30-APR-1999 MLR  Fixed bug introduced by new version of sinogram, need
                    to get size of reconstructed slices after centering
   18-MAY-1999 MLR  Changed formal parameter _extra to _ref_extra to allow
                    CENTER keyword value to be returned from sinogram (via
                    reconstruct_slice).
   23-FEB-2000 MLR  Pass extra keywords to read_tomo_volume
   7-MAR-2000  MLR  Added support for GRIDREC reconstruction, which reconstructs
                    2 slices at once.
   2-JAN-2001  MLR  Added CENTER keyword. If it is a 2-element array then the
                    center is interpolated.
   11-APR-2001 MLR  Incorporated the previous routine RECONSTRUCT_VOLUME into the
                    TOMO class library.
                    This procedure now updates the .SETUP file with the center
                    value which was used for the reconstruction.
   12-APR-2001 MLR  Added SCALE and angles keywords since we need to process them
                    here.
   11-APR-2002 MLR  Fixed bug introduced on 02-APR with center
</PRE><P>
<STRONG>(See tomo__define.pro)</STRONG><P>
<HR>
 
<A NAME="TOMO_FILTER">
<H2>TOMO_FILTER</H2></A>
<A HREF="#TOMO::RECONSTRUCT_VOLUME">[Previous Routine]</A>
<A HREF="#WRITE_TOMO_VOLUME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   TOMO_FILTER

 PURPOSE:
   Filters a sinogram before backprojection.  A selection of filters is
   available.

 CATEGORY:
   Tomography data processing

 CALLING SEQUENCE:
   Result = TOMO_FILTER(Sinogram, Filter_size, D)

 INPUTS:
   Sinogram:       The unfiltered sinogram.  This must be a 2-D array.

 OPTIONAL INPUTS:
   Filter_size:    The half-size of the filter in pixels.  The default is NX/4 where
                   NX is the first dimension of the sinogram.
   D:              An additional filter parameter.  The default is 1.0

 KEYWORD PARAMETERS:
   FILTER_NAME:  A case-insensitive string specifying the filter to be used.
                 Allowed values are:
                 'GEN_HAMMING'
                 'LP_COSINE'
                 'SHEPP_LOGAN'
                 'RAMLAK'
                 'NONE'
                 The default is 'SHEPP_LOGAN'
 OUTPUTS:
   This function returns the filtered sinogram.

 PROCEDURE:
   For each row in the sinogram, this function simply does the following:
       Pads the input sinogram
       Does a convolution with the appropriate filter
   The code for the filters was taken from the IDL tomography demo program
   which is included in the IDL distribution.  It would be easy to add
   additional filters in the future.

 EXAMPLE:
   f = tomo_filter(sinogram, filter_name='SHEPP_LOGAN')

 MODIFICATION HISTORY:
   Written by:     Mark Rivers, May 13, 1998
   25-Nov-2001  MLR  Changed the keywords from names of individual filters
                     (e.g. /SHEPP_LOGAN) to FILTER_NAME
                     Changed the default filter size from 32 to NX/4
</PRE><P>
<STRONG>(See tomo_filter.pro)</STRONG><P>
<HR>
 
<A NAME="WRITE_TOMO_VOLUME">
<H2>WRITE_TOMO_VOLUME</H2></A>
<A HREF="#TOMO_FILTER">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   WRITE_TOMO_VOLUME

 PURPOSE:
   Writes 3-D volume files to be read later by READ_TOMO_VOLUME or TOMO::
   READ-VOLUME.

   This function is a simple wrapper around TOMO::WRITE_VOLUME.
   See the documentation for <A HREF="#TOMO::WRITE_VOLUME">TOMO::WRITE_VOLUME </A>
   for more information.

 CATEGORY:
   Tomography data processing

 CALLING SEQUENCE:
   WRITE_TOMO_VOLUME, File, Volume

 PROCEDURE:
   This function simply creates a TOMO object and calls TOMO::WRITE_VOLUME.

 EXAMPLE:
   WRITE_TOMO_VOLUME, 'diamond2.volume', volume

 MODIFICATION HISTORY:
   Written by:     Mark Rivers, May 13, 1998
   26-JAN-2000  MLR  Added /swap_if_big_endian keyword to openw to allow
                     files to be read on big-endian machines.
   04-MAR-2001  MLR  Added support for netCDF file format.  Added NETCDF
                     and SETUP keywords
   11-APR-2001  MLR  Put the original version in the TOMO class library, made this
                     function simply create a TOMO object and call TOMO::WRITE_VOLUME.
</PRE><P>
<STRONG>(See write_tomo_volume.pro)</STRONG><P>
<HR>
 
</body>
</html>
